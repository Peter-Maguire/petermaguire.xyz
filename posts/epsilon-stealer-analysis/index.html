<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="ie=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=author content>
<meta name=description content="Spread Epsilon generally spreads via the game tester scam. The victim is prompted to try out a game from an itch.io link. The download generally contains an archive, usually RAR, which has a password. The password will be given to the victim via Discord, this is to try and evade automated scanning/execution by anyone other than the victim.
 An example DM a victim would receive   Infection Once the victim has downloaded the archive and extracted it, they will be faced with a Unity game.">
<meta name=keywords content="homepage,blog,malware,discord,reverse-engineering,discord-malware">
<meta name=robots content="noodp">
<meta name=theme-color content>
<link rel=canonical href=https://petermaguire.xyz/posts/epsilon-stealer-analysis/>
<title>
Epsilon Stealer Malware Analysis :: Peter Maguire
</title>
<link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css>
<link rel=stylesheet href=https://petermaguire.xyz/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css>
<link rel=apple-touch-icon sizes=180x180 href=https://petermaguire.xyz/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=https://petermaguire.xyz/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=https://petermaguire.xyz/favicon-16x16.png>
<link rel=manifest href=https://petermaguire.xyz/site.webmanifest>
<link rel=mask-icon href=https://petermaguire.xyz/safari-pinned-tab.svg color>
<link rel="shortcut icon" href=https://petermaguire.xyz/favicon.ico>
<meta name=msapplication-TileColor content>
<meta itemprop=name content="Epsilon Stealer Malware Analysis">
<meta itemprop=description content="Spread Epsilon generally spreads via the game tester scam. The victim is prompted to try out a game from an itch.io link. The download generally contains an archive, usually RAR, which has a password. The password will be given to the victim via Discord, this is to try and evade automated scanning/execution by anyone other than the victim.
 An example DM a victim would receive   Infection Once the victim has downloaded the archive and extracted it, they will be faced with a Unity game."><meta itemprop=datePublished content="2022-11-19T17:47:26+00:00">
<meta itemprop=dateModified content="2022-11-19T17:47:26+00:00">
<meta itemprop=wordCount content="1465"><meta itemprop=image content="https://petermaguire.xyz/">
<meta itemprop=keywords content="malware,discord,reverse-engineering,discord-malware,">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://petermaguire.xyz/">
<meta name=twitter:title content="Epsilon Stealer Malware Analysis">
<meta name=twitter:description content="Spread Epsilon generally spreads via the game tester scam. The victim is prompted to try out a game from an itch.io link. The download generally contains an archive, usually RAR, which has a password. The password will be given to the victim via Discord, this is to try and evade automated scanning/execution by anyone other than the victim.
 An example DM a victim would receive   Infection Once the victim has downloaded the archive and extracted it, they will be faced with a Unity game.">
<meta property="og:title" content="Epsilon Stealer Malware Analysis">
<meta property="og:description" content="Spread Epsilon generally spreads via the game tester scam. The victim is prompted to try out a game from an itch.io link. The download generally contains an archive, usually RAR, which has a password. The password will be given to the victim via Discord, this is to try and evade automated scanning/execution by anyone other than the victim.
 An example DM a victim would receive   Infection Once the victim has downloaded the archive and extracted it, they will be faced with a Unity game.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://petermaguire.xyz/posts/epsilon-stealer-analysis/"><meta property="og:image" content="https://petermaguire.xyz/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-11-19T17:47:26+00:00">
<meta property="article:modified_time" content="2022-11-19T17:47:26+00:00">
<meta property="article:published_time" content="2022-11-19 17:47:26 +0000 UTC">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=https://petermaguire.xyz/ style=text-decoration:none>
<div class=logo>
<span class=logo__mark>></span>
<span class=logo__text>~</span>
<span class=logo__cursor style=visibility:hidden>
</span>
</div>
</a>
<span class=header__right>
<nav class=menu>
<ul class=menu__inner><li><a href=https://petermaguire.xyz/posts>Blog</a></li><li><a href=https://petermaguire.xyz/work>CV</a></li><li><a href=https://petermaguire.xyz/projects>Projects</a></li>
</ul>
</nav>
<span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<main class=post>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
7 minutes
</p>
</div>
<article>
<h1 class=post-title>
<a href=https://petermaguire.xyz/posts/epsilon-stealer-analysis/>Epsilon Stealer Malware Analysis</a>
</h1>
<div class=post-content>
<h2 id=spread>Spread</h2>
<p>Epsilon generally spreads via the game tester scam.
The victim is prompted to try out a game from an itch.io link. The download generally contains an archive, usually RAR, which has a password.
The password will be given to the victim via Discord, this is to try and evade automated scanning/execution by anyone other than the victim.</p>
<figure><img src=https://petermaguire.xyz/img/epsilon/spread-example.png><figcaption>
<h4>An example DM a victim would receive</h4>
</figcaption>
</figure>
<h2 id=infection>Infection</h2>
<p>Once the victim has downloaded the archive and extracted it, they will be faced with a Unity game.
Other Discord malware attempts to masquerade as a Unity game by including files from unrelated legitimate games inside the archive.
Epsilon takes this a step further by wrapping the malicious code inside a Unity game shell which drops the second stage payload.
Scanning the executable with VirusTotal will also turn up clean and shares a hash with many legitimate Unity game launchers.</p>
<figure><img src=https://petermaguire.xyz/img/epsilon/archive-context.png><figcaption>
<h4>The archive contents</h4>
</figcaption>
</figure>
<p>When the victim launches the executable, a Unity game will launch and ask for a key.
The purpose of this key is unknown, but I would guess this is designed to be a confirmation that a user has actually executed the file.</p>
<p><figure><img src=https://petermaguire.xyz/img/epsilon/fake-out.png><figcaption>
<h4>Pretending to have run the game without asking for the key</h4>
</figcaption>
</figure>
<figure><img src=https://petermaguire.xyz/img/epsilon/enter-the-key.png><figcaption>
<h4>An example of the key entry screen</h4>
</figcaption>
</figure>
</p>
<p>With a correct key entry, a very basic game will launch. This game is usually ripped directly from elsewhere,
and only serves to convince the victim that the attacker&rsquo;s request was legitimate.</p>
<h2 id=payload>Payload</h2>
<p>Upon launching the game, the Unity shell drops an application called <a href=https://www.virustotal.com/gui/file/b3b1578ad65142d2c12d2db14e1fcfc7d76c0cbd6bb97655a6c6b70ff9e959c7>GameManager</a> into <code>%LocalAppData%\Temp\[random]\[random]</code> and then executes it.</p>
<p>GameManager is an Electron based application which executes the initial malicious payload and also displays the &ldquo;game&rdquo; that is shown to the user.</p>
<figure><img src=https://petermaguire.xyz/img/epsilon/game-manager.png><figcaption>
<h4>The GameManager program</h4>
</figcaption>
</figure>
<h3 id=information-gathering>Information Gathering</h3>
<h4 id=iplocation-data>IP/Location Data</h4>
<p>The malware retrieves the users external IP address and geolocation data from <a href=https://ipinfo.io>ipinfo.io</a>.</p>
<h4 id=chromium-data>Chromium Data</h4>
<p>Epsilon looks for Chromium data in the following locations, corresponding to Discord, Chrome, Operate, Brave, Yandex, Edge and Vivaldi install locations.
Paths containing {number} are iterated over 5 times, substituting {number} with a number 1-5.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>appData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>APPDATA</span>; <span style=color:#75715e>// Default: C:\Users\[username]\AppData\Roaming
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>LOCALAPPDATA</span>; <span style=color:#75715e>// Default: C:\Users\[username]\AppData\Local
</span><span style=color:#75715e></span><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>chromiumPaths</span> <span style=color:#f92672>=</span> [
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\discord\\&#34;</span>,
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\discordcanary\\&#34;</span>,
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\discordptb\\&#34;</span>,
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\discorddevelopment\\&#34;</span>,
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\lightcord\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Google\\Chrome\\User Data\\Default\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Google\\Chrome\\User Data\\Guest Profile\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Google\\Chrome\\User Data\\Default\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Google\\Chrome\\User Data\\Guest Profile\\Network\\&#34;</span>,
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Opera Software\\Opera Stable\\&#34;</span>,
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Opera Software\\Opera GX Stable\\&#34;</span>,
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Opera Software\\Opera Stable\\Network\\&#34;</span>,
    <span style=color:#a6e22e>appData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Opera Software\\Opera GX Stable\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\BraveSoftware\\Brave-Browser\\User Data\\Default\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\BraveSoftware\\Brave-Browser\\User Data\\Guest Profile\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\BraveSoftware\\Brave-Browser\\User Data\\Default\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\BraveSoftware\\Brave-Browser\\User Data\\Guest Profile\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Yandex\\YandexBrowser\\User Data\\Guest Profile\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Yandex\\YandexBrowser\\User Data\\Guest Profile\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Microsoft\\Edge\\User Data\\Default\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Microsoft\\Edge\\User Data\\Guest Profile\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Microsoft\\Edge\\User Data\\Default\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Microsoft\\Edge\\User Data\\Guest Profile\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Vivaldi\\User Data\\Default\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Vivaldi\\User Data\\Guest Profile\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Vivaldi\\User Data\\Default\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Vivaldi\\User Data\\Guest Profile\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Google\\Chrome\\User Data\\Profile {number}\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\BraveSoftware\\Brave-Browser\\User Data\\Profile {number}\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Yandex\\YandexBrowser\\User Data\\Profile {number}\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Microsoft\\Edge\\User Data\\Profile {number}\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Vivaldi\\User Data\\Profile {number}\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Google\\Chrome\\User Data\\Profile {number}\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\BraveSoftware\\Brave-Browser\\User Data\\Profile {number}\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Yandex\\YandexBrowser\\User Data\\Profile {number}\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Microsoft\\Edge\\User Data\\Profile {number}\\Network\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Vivaldi\\User Data\\Profile {number}\\Network\\&#34;</span>
];
</code></pre></div><p>The malware iterates over the list multiple times to extract the following information, skipping over the paths which contain the phrase <code>cord</code>:</p>
<ul>
<li>Cookies</li>
<li>Saved Passwords</li>
<li>Autofill data</li>
<li>Saved Cards</li>
</ul>
<p>The results of these extractions are stored a temp directory created with <code>os.createtempdir()</code>.</p>
<p>The list is iterated a final time to retrieve Discord login data specifically.</p>
<ul>
<li>For paths including the phrase <code>discord</code>:
<ul>
<li>The <code>Local State</code> file is read to extract the login decryption key.</li>
<li>The login decryption key is decrypted using <a href=https://github.com/daguej/node-dpapi>DPAPI unprotectData</a></li>
<li>The folder <code>Local Storage\leveldb</code> is iterated over, reading each file which ends in <code>.log</code> or <code>.ldb</code></li>
<li>Each file is opened as text, and it attempts to match the regex for an encrypted Discord token <code>dQw4w9WgXcQ:[^.*\['(.*)'\].*$][^\"]*</code></li>
<li>For each match, the encrypted element of the token is extracted and decrypted using the key retrieved earlier</li>
<li>The decrypted token is pushed to the results array</li>
</ul>
</li>
<li>For all other paths:
<ul>
<li>The <code>.log</code> and <code>.ldb</code> files are retrieved from <code>Local Storage\leveldb</code> as before</li>
<li>The files are opened as text, and the regex for an unencrypted Discord token is used <code>[\w-]{24}.[\w-]{6}.[\w-]{25,110}</code></li>
<li>The token is pushed to the results array</li>
</ul>
</li>
</ul>
<h4 id=firefox-data>Firefox Data</h4>
<p>Similar to Chromium data extraction, the following data is extracted from <code>%APPDATA%\Mozilla\Firefox\Profiles</code>:</p>
<ul>
<li>Saved Passwords</li>
<li>Cookies</li>
<li>Autofill data</li>
</ul>
<p>The results of these extractions are stored in the same temp directory as the Chromium data, under a sub-folder called <code>epsilon-[username]</code>.
Interestingly, no attempt is made to extract Discord tokens from Firefox.</p>
<h4 id=discord>Discord</h4>
<p>The tokens retrieved from Chromium data extraction are used to extract the following info:</p>
<ul>
<li>Account badges</li>
<li>Nitro subscription (if any)</li>
<li>Email address</li>
<li>Payment sources</li>
<li>Phone Number</li>
<li>HQ Friends list</li>
</ul>
<p>Epsilon downloads and injects a payload into the Discord client which is used for further data extraction.
The following paths are checked for a Discord installation:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>discordPaths</span> <span style=color:#f92672>=</span> [
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\discord\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\discordcanary\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\discordptb\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\discorddevelopment\\&#34;</span>,
    <span style=color:#a6e22e>localAppData</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\lightcord\\&#34;</span>
];
</code></pre></div><p>If a Discord installation is found, it then attempts to <a href=https://en.wikipedia.org/wiki/Glob_(programming)>glob</a> match a file with the path
<code>\app-*\modules\discord_desktop_core-*\discord_desktop_core\index.js</code>. This path corresponds to a plaintext JS file which is executed before the Discord client is initialised,
and is usually contains a single line. Epsilon downloads a payload from a paste service and overwrites <code>index.js</code> with the contents of the paste.
A directory is also made called <code>Epsilon-Stealer</code> as a crude way of signalling that the injection is successful. This is a common practise in stealers,
and in most the presence of this directory is checked for in order to decide whether to continue with the infection, however it doesn&rsquo;t appear to be used here.</p>
<p>The presence of BetterDiscord is also checked for and, if found, BetterDiscord&rsquo;s &lsquo;webhook protection&rsquo; feature is
disabled by overwriting the string <code>api/webhooks</code> with <code>vulsa1111</code> in <code>\BetterDiscord\data\betterdiscord.asar</code></p>
<p>The following paths are also checked for a file which contains the phrase <code>discord_backup_codes</code>, presumably hoping to find a file containing 2FA backup codes.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>userProfile</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>USERPROFILE</span>;
<span style=color:#a6e22e>userPaths</span> <span style=color:#f92672>=</span> [
    <span style=color:#a6e22e>userProfile</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Desktop\\&#34;</span>,
    <span style=color:#a6e22e>userProfile</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Downloads\\&#34;</span>,
    <span style=color:#a6e22e>userProfile</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\\Documents\\&#34;</span>
];
</code></pre></div><h4 id=cryptocurrency>Cryptocurrency</h4>
<p>Each non-discord chromium path is checked for the following extensions, and the data is extracted from each:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>cryptoExtensions</span>[<span style=color:#e6db74>&#34;Local Extension Settings\\nkbihfbeogaeaoehlefnkodbefgpgknn&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Metamask&#34;</span>;
<span style=color:#a6e22e>cryptoExtensions</span>[<span style=color:#e6db74>&#34;Local Extension Settings\\bfnaelmomeimhlpmgjnjophhpkkoljpa&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Phantom&#34;</span>;
<span style=color:#a6e22e>cryptoExtensions</span>[<span style=color:#e6db74>&#34;Local Extension Settings\\fhbohimaelbohpjbbldcngcnapndodjp&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Binance&#34;</span>;
<span style=color:#a6e22e>cryptoExtensions</span>[<span style=color:#e6db74>&#34;Local Extension Settings\\hnfanknocfeofbddgcijnmhnfnkdnaad&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Coinbase&#34;</span>;
<span style=color:#a6e22e>cryptoExtensions</span>[<span style=color:#e6db74>&#34;Local Extension Settings\\aeachknmefphepccionboohckonoeemg&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Coin98&#34;</span>;
<span style=color:#a6e22e>cryptoExtensions</span>[<span style=color:#e6db74>&#34;Local Extension Settings\\hifafgmccdpekplomjjkcfgodnhcellj&#34;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Crypto_com&#34;</span>;
</code></pre></div><p><code>%APPDATA%\Exodus\exodus.wallet</code> is also checked for and extracted.</p>
<p>The data for Crypto wallets is stored in <code>[temp dir]\epsilon-[username]\Wallets</code>.</p>
<h4 id=telegram>Telegram</h4>
<p>Epsilon checks for the existence of <code>%APPDATA%\Telegram Desktop\tdata</code>, lists all sub-dirs and files and:</p>
<ul>
<li>If a sub-directory name is exactly 16 letters long, the contents of the directory is extracted</li>
<li>If a filename ends in s and is exactly 17 letters long, the file is extracted</li>
</ul>
<p>The malware also attempts to extract the <code>usertag</code>, <code>settingss</code> and <code>key_datas</code> files from the <code>tdata</code> directory,
due to poor programming it copies each of these files once for every file inside the <code>tdata</code> directory.</p>
<p>The extracted data is copied to <code>[temp dir]\epsilon-[username]\Messengers\Telegram</code></p>
<h4 id=mobaxterm>MobaXterm</h4>
<p>Interestingly, Epsilon targets <a href=https://mobaxterm.mobatek.net/>MobaXTerm</a>, extracting <code>%APPDATA%\MobaXterm\MobaXterm.ini</code>
and storing it in <code>[temp dir]\epsilon-[username]\Ftps</code>. This is the only SSH client that is targeted.</p>
<h4 id=filezilla>FileZilla</h4>
<p><a href=https://filezilla-project.org/>FileZilla</a> is also targeted, extracting <code>%APPDATA%\FileZilla\filezilla.xml</code>
and storing it in <code>[temp dir]\epsilon-[username]\Ftps</code></p>
<h2 id=exfiltration>Exfiltration</h2>
<p>Data is sent back to the attacker via a Discord webhook. This webhook is retrieved from a paste service,
although in one of the samples analysed the paste was retrieved but its result was discarded in favour of a hardcoded webhook.</p>
<p>Once all the above data has been extracted, the entire <code>epsilon-[username]</code> folder is compressed into a zip file.
The zip file is then uploaded to the webhook, along with two embeds.
One which summarises the number of each type of data that has been extracted, along with the computer name, username and IP address.
The other which shows the Discord specific information.</p>
<figure><img src=https://petermaguire.xyz/img/epsilon/epsilon-icons.png><figcaption>
<h4>The emojis used in the embeds</h4>
</figcaption>
</figure>
<p>The Discord specific embed uses emojis which are prefixed with EM_, and were created between 2022-02-02 and 2022-07-05,
with one emoji being created a year earlier on 2021-02-26.</p>
<p>The summary embed refers to messengers as &ldquo;Applications de communications&rdquo;, suggesting that the creator is French-speaking.</p>
<h2 id=evasion>Evasion</h2>
<p>Epsilon does not appear to try and evade detection or analysis in any way.
The name &ldquo;Epsilon&rdquo; is written in several places inside the malware, with each embed and file being marked with the name.</p>
<h2 id=persistence>Persistence</h2>
<p>After the initial data extraction is complete, a second version of the malware titled <a href=https://www.virustotal.com/gui/file/3a3e3f8bb3ea348375c6afad7f6f28a90040c178ac29b378b60e6798cbf8c3ac>WindowsBootManager.exe</a> is downloaded from
the Discord CDN and moved into <code>%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup</code>. This file appears to be functionally
identical to the original malware, but without the game. In the latest sample, this file was uploaded on 2022-11-11.</p>
<p>Interestingly, if the package <code>electron-squirrel-startup</code> is detected, the app quits immediately before running its payload.</p>
</div>
</article>
<hr>
<div class=post-info>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg>
<span class=tag><a href=https://petermaguire.xyz/tags/malware/>malware</a></span>
<span class=tag><a href=https://petermaguire.xyz/tags/discord/>discord</a></span>
<span class=tag><a href=https://petermaguire.xyz/tags/reverse-engineering/>reverse-engineering</a></span>
<span class=tag><a href=https://petermaguire.xyz/tags/discord-malware/>discord-malware</a></span>
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
1465 Words
</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
2022-11-19 17:47
</p>
</div>
<hr>
<div class=sharing-buttons>
<a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f" target=_blank rel=noopener aria-label title="Share on facebook">
<div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f" target=_blank rel=noopener aria-label title="Share on twitter">
<div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=Epsilon%20Stealer%20Malware%20Analysis&caption=Epsilon%20Stealer%20Malware%20Analysis&canonicalUrl=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f" target=_blank rel=noopener aria-label title="Share on tumblr">
<div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
<div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="mailto:?subject=Epsilon%20Stealer%20Malware%20Analysis&body=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f" target=_self rel=noopener aria-label title="Share via email">
<div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f&media=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f;description=Epsilon%20Stealer%20Malware%20Analysis" target=_blank rel=noopener aria-label title="Share on pinterest">
<div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f&title=Epsilon%20Stealer%20Malware%20Analysis&summary=Epsilon%20Stealer%20Malware%20Analysis&source=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f" target=_blank rel=noopener aria-label title="Share on linkedin">
<div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f&resubmit=true&title=Epsilon%20Stealer%20Malware%20Analysis" target=_blank rel=noopener aria-label title="Share on reddit">
<div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f;title=Epsilon%20Stealer%20Malware%20Analysis" target=_blank rel=noopener aria-label title="Share on xing">
<div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="whatsapp://send?text=Epsilon%20Stealer%20Malware%20Analysis%20https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f" target=_blank rel=noopener aria-label title="Share on whatsapp">
<div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f&t=Epsilon%20Stealer%20Malware%20Analysis" target=_blank rel=noopener aria-label title="Share on hacker news">
<div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
</div>
</div>
</a>
<a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Epsilon%20Stealer%20Malware%20Analysis&url=https%3a%2f%2fpetermaguire.xyz%2fposts%2fepsilon-stealer-analysis%2f" target=_blank rel=noopener aria-label title="Share on telegram">
<div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
</div>
</div>
</a>
</div>
<div class=pagination>
<div class=pagination__buttons>
<span class="button previous">
<a href=https://petermaguire.xyz/posts/bbystealer-analysis/>
<span class=button__icon>←</span>
<span class=button__text>BbyStealer Analysis</span>
</a>
</span>
</div>
</div>
</main>
</div>
<footer class=footer>
</footer>
</div>
<script type=text/javascript src=https://petermaguire.xyz/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>
</body>
</html>